<?xml version="1.0" encoding="UTF-8"?>
<!--PATCHINFO id="8de9fe40003863d2199a5b2500f85408"!-->
<patch
    xmlns="http://novell.com/package/metadata/suse/patch"
    xmlns:yum="http://linux.duke.edu/metadata/common"
    xmlns:rpm="http://linux.duke.edu/metadata/rpm"
    xmlns:suse="http://novell.com/package/metadata/suse/common"
    patchid="MozillaFirefox-1981"
    timestamp="1155517706"
    engine="1.0">
  <yum:name>MozillaFirefox</yum:name>
  <summary lang="en">MozillaFirefox: Security update to version 1.5.0.6</summary>
  <summary lang="de">MozillaFirefox: Sicherheitsupdate auf Version 1.5.0.6</summary>
  <description lang="en">This security update brings Mozilla Firefox to version
1.5.0.6.

Note that on SUSE Linux 9.2, 9.3 and 10.0 this is a major
version upgrade, please check if your manually installed
extensions and plugins are still working.

Please also see
http://www.mozilla.org/projects/security/known-vulnerabiliti
es.html for more details.

It includes fixes to the following security problems:
- CVE-2006-3801/MFSA 2006-44: Code execution through
  deleted frame reference

  Thilo Girmann discovered that in certain circumstances a
JavaScript reference to a frame or window was not properly
cleared when the referenced content went away, and he
demonstrated that this pointer to a deleted object could be
used to execute native code supplied by the attacker.

- CVE-2006-3677/MFSA 2006-45: Javascript navigator Object
  Vulnerability

  An anonymous researcher for TippingPoint and the Zero Day
Initiative showed that when used in a web page Java would
reference properties of the window.navigator object as it
started up. If the page replaced the navigator object
before starting Java then the browser would crash in a way
that could be exploited to run native code supplied by the
attacker.

- CVE-2006-3113/MFSA 2006-46: Memory corruption with
  simultaneous events

  Secunia Research has discovered a vulnerability in
Mozilla Firefox 1.5 branch, which can be exploited by
malicious people to compromise a user's system.

  The vulnerability is caused due to an memory corruption
error within the handling of simultaneously happening XPCOM
events, which leads to use of a deleted timer object. This
generally results in a crash but potentially could be
exploited to execute arbitrary code on a user's system when
a malicious website is visited.

- CVE-2006-3802/MFSA 2006-47: Native DOM methods can be
  hijacked across domains

  A malicious page can hijack native DOM methods on a
document object in another domain, which will run the
attacker's script when called by the victim page.  This
could be used to steal login cookies, password, or other
sensitive data on the target page, or to perform actions on
behalf of a logged-in user.

  Access checks on all other properties and document nodes
are performed correctly. This cross-site scripting (XSS)
attack is limited to pages which use standard DOM methods
of the top-level document object, such as
document.getElementById(). This includes many popular
sites, especially the newer ones that offer rich
interaction to the user.

- CVE-2006-3803/MFSA 2006-48: JavaScript new Function race
  condition

  H. D. Moore reported a testcase that was able to trigger
a race condition where JavaScript garbage collection
deleted a temporary variable still being used in the
creation of a new Function object. The resulting use of a
deleted object may be potentially exploitable to run native
code provided by the attacker.

- CVE-2006-3804/MFSA 2006-49: Heap buffer overwrite on
  malformed VCard

  A VCard attachment with a malformed base64 field (such as
a photo) can trigger a heap buffer overwrite. These have
proven exploitable in the past, though in this case the
overwrite is accompanied by an integer underflow that would
attempt to copy more data than the typical machine has,
leading to a crash.

- CVE-2006-3805/CVE-2006-3806/MFSA 2006-50: JavaScript
  engine vulnerabilities

  Continuing our security audit of the JavaScript engine,
Mozilla developers found and fixed several potential
vulnerabilities.

  Igor Bukanov and shutdown found additional places where
an untimely garbage collection could delete a temporary
object that was in active use (similar to MFSA 2006-01 and
MFSA 2006-10). Some of these may allow an attacker to run
arbitrary code given the right conditions.

  Georgi Guninski found potential integer overflow issues
with long strings in the toSource() methods of the Object,
Array and String objects as well as string function
arguments.

- CVE-2006-3807/MFSA 2006-51: Privilege escalation using
  named-functions and redefined &quot;new Object()&quot;

  moz_bug_r_a4 discovered that named JavaScript functions
have a parent object created using the standard Object()
constructor (ECMA-specified behavior) and that this
constructor can be redefined by script (also ECMA-specified
behavior). If the Object() constructor is changed to return
a reference to a privileged object with useful properties
it is possible to have attacker-supplied script excuted
with elevated privileges by calling the function. This
could be used to install malware or take other malicious
actions.

  Our fix involves calling the internal Object constructor
which appears to be what other ECMA-compatible interpreters
do.

- CVE-2006-3808/MFSA 2006-52: PAC privilege escalation
  using Function.prototype.call

  moz_bug_r_a4 reports that a malicious Proxy AutoConfig
(PAC) server could serve a PAC script that can execute code
with elevated privileges by setting the required
FindProxyForURL function to the eval method on a privileged
object that leaked into the PAC sandbox. By redirecting the
victim to a specially-crafted URL -- easily done since the
PAC script controls which proxy to use -- the URL
&quot;hostname&quot; can be executed as privileged script.

  A malicious proxy server can perform spoofing attacks on
the user so it was already important to use a trustworthy
PAC server.

- CVE-2006-3809/MFSA 2006-53: UniversalBrowserRead
  privilege escalation

  shutdown reports that scripts granted the
UniversalBrowserRead privilege can leverage that into the
equivalent of the far more powerful UniversalXPConnect
since they are allowed to &quot;read&quot; into a privileged context.
This allows the attacker the ability to run scripts with
the full privelege of the user running the browser,
possibly installing malware or snooping on private data.
This has been fixed so that UniversalBrowserRead and
UniversalBrowserWrite are limited to reading from and
writing into only normally-privileged browser windows and
frames.

- CVE-2006-3810/MFSA 2006-54: XSS with
  XPCNativeWrapper(window).Function(...)

  shutdown reports that cross-site scripting (XSS) attacks
could be performed using the construct
XPCNativeWrapper(window).Function(...), which created a
function that appeared to belong to the window in question
even after it had been navigated to the target site.

- CVE-2006-3811/MFSA 2006-55: Crashes with evidence of
  memory corruption

  As part of the Firefox 1.5.0.5 stability and security
release, developers in the Mozilla community looked for and
fixed several crash bugs to improve the stability of
Mozilla clients. Some of these crashes showed evidence of
memory corruption that we presume could be exploited to run
arbitrary code with enough effort.

- CVE-2006-3812/MFSA 2006-56: chrome: scheme loading remote
  content

  Benjamin Smedberg discovered that chrome URL's could be
made to reference remote files, which would run scripts
with full privilege. There is no known way for web content
to successfully load a chrome: url, but if a user could be
convinced to do so manually (perhaps by copying a link and
pasting it into the location bar) this could be exploited.
</description>
  <description lang="de">Dieses Sicherheitsupdate bringt Mozilla Firefox auf Version
1.5.0.6.

Für SUSE Linux 9.2, 9.3 und 10.0 ist dies ein grosser
Versionssprung, bitte überprüfen Sie, ob Ihre manuell
installierten Plugins bzw. Extensions danach noch
funktionieren.

Mehr Details sind auf:
http://www.mozilla.org/projects/security/known-vulnerabiliti
es.html

Das Update beinhaltet folgende Sicherheitsfixes (Details in
englisch):
- CVE-2006-3801/MFSA 2006-44: Code execution through
  deleted frame reference

  Thilo Girmann discovered that in certain circumstances a
JavaScript reference to a frame or window was not properly
cleared when the referenced content went away, and he
demonstrated that this pointer to a deleted object could be
used to execute native code supplied by the attacker.

- CVE-2006-3677/MFSA 2006-45: Javascript navigator Object
  Vulnerability

  An anonymous researcher for TippingPoint and the Zero Day
Initiative showed that when used in a web page Java would
reference properties of the window.navigator object as it
started up. If the page replaced the navigator object
before starting Java then the browser would crash in a way
that could be exploited to run native code supplied by the
attacker.

- CVE-2006-3113/MFSA 2006-46: Memory corruption with
  simultaneous events

  Secunia Research has discovered a vulnerability in
Mozilla Firefox 1.5 branch, which can be exploited by
malicious people to compromise a user's system.

  The vulnerability is caused due to an memory corruption
error within the handling of simultaneously happening XPCOM
events, which leads to use of a deleted timer object. This
generally results in a crash but potentially could be
exploited to execute arbitrary code on a user's system when
a malicious website is visited.

- CVE-2006-3802/MFSA 2006-47: Native DOM methods can be
  hijacked across domains

  A malicious page can hijack native DOM methods on a
document object in another domain, which will run the
attacker's script when called by the victim page.  This
could be used to steal login cookies, password, or other
sensitive data on the target page, or to perform actions on
behalf of a logged-in user.

  Access checks on all other properties and document nodes
are performed correctly. This cross-site scripting (XSS)
attack is limited to pages which use standard DOM methods
of the top-level document object, such as
document.getElementById(). This includes many popular
sites, especially the newer ones that offer rich
interaction to the user.

- CVE-2006-3803/MFSA 2006-48: JavaScript new Function race
  condition

  H. D. Moore reported a testcase that was able to trigger
a race condition where JavaScript garbage collection
deleted a temporary variable still being used in the
creation of a new Function object. The resulting use of a
deleted object may be potentially exploitable to run native
code provided by the attacker.

- CVE-2006-3804/MFSA 2006-49: Heap buffer overwrite on
  malformed VCard

  A VCard attachment with a malformed base64 field (such as
a photo) can trigger a heap buffer overwrite. These have
proven exploitable in the past, though in this case the
overwrite is accompanied by an integer underflow that would
attempt to copy more data than the typical machine has,
leading to a crash.

- CVE-2006-3806/MFSA 2006-50: JavaScript engine
  vulnerabilities

  Continuing our security audit of the JavaScript engine,
Mozilla developers found and fixed several potential
vulnerabilities.

  Igor Bukanov and shutdown found additional places where
an untimely garbage collection could delete a temporary
object that was in active use (similar to MFSA 2006-01 and
MFSA 2006-10). Some of these may allow an attacker to run
arbitrary code given the right conditions.

  Georgi Guninski found potential integer overflow issues
with long strings in the toSource() methods of the Object,
Array and String objects as well as string function
arguments.

- CVE-2006-3807/MFSA 2006-51: Privilege escalation using
  named-functions and redefined &quot;new Object()&quot;

  moz_bug_r_a4 discovered that named JavaScript functions
have a parent object created using the standard Object()
constructor (ECMA-specified behavior) and that this
constructor can be redefined by script (also ECMA-specified
behavior). If the Object() constructor is changed to return
a reference to a privileged object with useful properties
it is possible to have attacker-supplied script excuted
with elevated privileges by calling the function. This
could be used to install malware or take other malicious
actions.

  Our fix involves calling the internal Object constructor
which appears to be what other ECMA-compatible interpreters
do.

- CVE-2006-3808/MFSA 2006-52: PAC privilege escalation
  using Function.prototype.call

  moz_bug_r_a4 reports that a malicious Proxy AutoConfig
(PAC) server could serve a PAC script that can execute code
with elevated privileges by setting the required
FindProxyForURL function to the eval method on a privileged
object that leaked into the PAC sandbox. By redirecting the
victim to a specially-crafted URL -- easily done since the
PAC script controls which proxy to use -- the URL
&quot;hostname&quot; can be executed as privileged script.

  A malicious proxy server can perform spoofing attacks on
the user so it was already important to use a trustworthy
PAC server.

- CVE-2006-3809/MFSA 2006-53: UniversalBrowserRead
  privilege escalation

  shutdown reports that scripts granted the
UniversalBrowserRead privilege can leverage that into the
equivalent of the far more powerful UniversalXPConnect
since they are allowed to &quot;read&quot; into a privileged context.
This allows the attacker the ability to run scripts with
the full privelege of the user running the browser,
possibly installing malware or snooping on private data.
This has been fixed so that UniversalBrowserRead and
UniversalBrowserWrite are limited to reading from and
writing into only normally-privileged browser windows and
frames.

- CVE-2006-3810/MFSA 2006-54: XSS with
  XPCNativeWrapper(window).Function(...)

  shutdown reports that cross-site scripting (XSS) attacks
could be performed using the construct
XPCNativeWrapper(window).Function(...), which created a
function that appeared to belong to the window in question
even after it had been navigated to the target site.

- CVE-2006-3811/MFSA 2006-55: Crashes with evidence of
  memory corruption

  As part of the Firefox 1.5.0.5 stability and security
release, developers in the Mozilla community looked for and
fixed several crash bugs to improve the stability of
Mozilla clients. Some of these crashes showed evidence of
memory corruption that we presume could be exploited to run
arbitrary code with enough effort.

- CVE-2006-3812/MFSA 2006-56: chrome: scheme loading remote
  content

  Benjamin Smedberg discovered that chrome URL's could be
made to reference remote files, which would run scripts
with full privilege. There is no known way for web content
to successfully load a chrome: url, but if a user could be
convinced to do so manually (perhaps by copying a link and
pasting it into the location bar) this could be exploited.
</description>
  <yum:version ver="1981" rel="0"/>
  <rpm:requires>
    <rpm:entry kind="atom" name="MozillaFirefox" epoch="0" ver="1.5.0.6" rel="1.3" flags="EQ"/>
    <rpm:entry kind="atom" name="MozillaFirefox-translations" epoch="0" ver="1.5.0.6" rel="1.3" flags="EQ"/>
  </rpm:requires>
  <category>security</category>
  <atoms>
    <package xmlns="http://linux.duke.edu/metadata/common" type="rpm">
      <name>MozillaFirefox</name>
      <arch>i586</arch>
      <version epoch="0" ver="1.5.0.6" rel="1.3"/>
      <checksum type="sha" pkgid="YES">c47803492f34650ddabda93c3d82814d62fd5283</checksum>
      <time file="1155660727" build="1155517706"/>
      <size package="7221366" installed="18766151" archive="18800780"/>
      <location href="rpm/i586/MozillaFirefox-1.5.0.6-1.3.i586.rpm"/>
      <format>
        <rpm:requires>
          <rpm:entry kind="package" name="MozillaFirefox" epoch="0" ver="1.5.0.6" rel="1.3" flags="GE"/>
        </rpm:requires>
        <suse:freshens>
          <suse:entry kind="package" name="MozillaFirefox"/>
        </suse:freshens>
      </format>
      <pkgfiles xmlns="http://novell.com/package/metadata/suse/patch">
        <patchrpm>
          <location href="rpm/i586/MozillaFirefox-1.5.0.6-1.3.i586.patch.rpm"/>
          <checksum type="sha">8bc36c099b6da97a27036b60639071b399669f5a</checksum>
          <time file="1155661982" build="1155517706"/>
          <size package="5399284" archive="14534504"/>
          <base-version epoch="0" ver="1.5.0.3" rel="7"/>
          <base-version epoch="0" ver="1.5.0.4" rel="1.3"/>
        </patchrpm>
        <deltarpm>
          <location href="rpm/i586/MozillaFirefox-1.5.0.3_1.5.0.6-7_1.3.i586.delta.rpm"/>
          <checksum type="sha">981cfe6635ccf368377671ed5ada9ebbcfe13e51</checksum>
          <time file="1155661994" build="1155517706"/>
          <size package="806937" archive="0"/>
          <base-version epoch="0" ver="1.5.0.3" rel="7" md5sum="7b8339c824bba3828f8d7bf05b0030b0" buildtime="1146621086" sequence_info="MozillaFirefox-1.5.0.3-7-f278b756b1638aad1a236d9d5d02a6f1ca30"/>
        </deltarpm>
        <deltarpm>
          <location href="rpm/i586/MozillaFirefox-1.5.0.4_1.5.0.6-1.3.i586.delta.rpm"/>
          <checksum type="sha">a862c98e4d54a5c600ac67a5d058db527f3ec06e</checksum>
          <time file="1155662006" build="1155517706"/>
          <size package="2120948" archive="0"/>
          <base-version epoch="0" ver="1.5.0.4" rel="1.3" md5sum="86c51e4ea35fbcb0c6979cf96ef4c60c" buildtime="1150143317" sequence_info="MozillaFirefox-1.5.0.4-1.3-5d1bcd4cff3d9718d8bfe6ec1263837b71116111961b1161af1120"/>
        </deltarpm>
      </pkgfiles>
    </package>
    <package xmlns="http://linux.duke.edu/metadata/common" type="rpm">
      <name>MozillaFirefox</name>
      <arch>ppc</arch>
      <version epoch="0" ver="1.5.0.6" rel="1.3"/>
      <checksum type="sha" pkgid="YES">1c523e99c497022685fd335816dbe9226c857375</checksum>
      <time file="1155660908" build="1155562799"/>
      <size package="7347662" installed="21963199" archive="21997828"/>
      <location href="rpm/ppc/MozillaFirefox-1.5.0.6-1.3.ppc.rpm"/>
      <format>
        <rpm:requires>
          <rpm:entry kind="package" name="MozillaFirefox" epoch="0" ver="1.5.0.6" rel="1.3" flags="GE"/>
        </rpm:requires>
        <suse:freshens>
          <suse:entry kind="package" name="MozillaFirefox"/>
        </suse:freshens>
      </format>
      <pkgfiles xmlns="http://novell.com/package/metadata/suse/patch">
        <patchrpm>
          <location href="rpm/ppc/MozillaFirefox-1.5.0.6-1.3.ppc.patch.rpm"/>
          <checksum type="sha">62dac1b4d0a1639f5a11fb0af2b47bc57959b6ca</checksum>
          <time file="1155662023" build="1155562799"/>
          <size package="5540825" archive="17737188"/>
          <base-version epoch="0" ver="1.5.0.3" rel="7"/>
          <base-version epoch="0" ver="1.5.0.4" rel="1.3"/>
        </patchrpm>
        <deltarpm>
          <location href="rpm/ppc/MozillaFirefox-1.5.0.3_1.5.0.6-7_1.3.ppc.delta.rpm"/>
          <checksum type="sha">1558b518a2c103812dca018ff3f2c349e6e89eef</checksum>
          <time file="1155662035" build="1155562799"/>
          <size package="699556" archive="0"/>
          <base-version epoch="0" ver="1.5.0.3" rel="7" md5sum="56603a3fddfcae8b426f413978329c84" buildtime="1146627070" sequence_info="MozillaFirefox-1.5.0.3-7-e8db1de78dc8f13cd00f6db16038708fca30"/>
        </deltarpm>
        <deltarpm>
          <location href="rpm/ppc/MozillaFirefox-1.5.0.4_1.5.0.6-1.3.ppc.delta.rpm"/>
          <checksum type="sha">0f838f2b923a74cd6b2a7b9c2a88f1aff8401a6b</checksum>
          <time file="1155662048" build="1155562799"/>
          <size package="2016886" archive="0"/>
          <base-version epoch="0" ver="1.5.0.4" rel="1.3" md5sum="5ec8af0efb500f6a58b961632153a59b" buildtime="1150146297" sequence_info="MozillaFirefox-1.5.0.4-1.3-0a2907c2154b5d845f912178f3ed814871116111961b1161af1120"/>
        </deltarpm>
      </pkgfiles>
    </package>
    <package xmlns="http://linux.duke.edu/metadata/common" type="rpm">
      <name>MozillaFirefox-translations</name>
      <arch>i586</arch>
      <version epoch="0" ver="1.5.0.6" rel="1.3"/>
      <checksum type="sha" pkgid="YES">dccaddaf1e6ffb91649045c0dafbf125ec38c935</checksum>
      <time file="1155660741" build="1155517706"/>
      <size package="3754395" installed="20862963" archive="20872868"/>
      <location href="rpm/i586/MozillaFirefox-translations-1.5.0.6-1.3.i586.rpm"/>
      <format>
        <rpm:requires>
          <rpm:entry kind="package" name="MozillaFirefox-translations" epoch="0" ver="1.5.0.6" rel="1.3" flags="GE"/>
        </rpm:requires>
        <suse:freshens>
          <suse:entry kind="package" name="MozillaFirefox-translations"/>
        </suse:freshens>
      </format>
      <pkgfiles xmlns="http://novell.com/package/metadata/suse/patch">
        <patchrpm>
          <location href="rpm/i586/MozillaFirefox-translations-1.5.0.6-1.3.i586.patch.rpm"/>
          <checksum type="sha">22d49c324a756b936820ce5d13616967d94a20d4</checksum>
          <time file="1155662058" build="1155517706"/>
          <size package="259779" archive="1494044"/>
          <base-version epoch="0" ver="1.5.0.3" rel="7"/>
          <base-version epoch="0" ver="1.5.0.4" rel="1.3"/>
        </patchrpm>
        <deltarpm>
          <location href="rpm/i586/MozillaFirefox-translations-1.5.0.3_1.5.0.6-7_1.3.i586.delta.rpm"/>
          <checksum type="sha">cccd88a11adc0fd1486afa71072d68e1ab24ead1</checksum>
          <time file="1155662064" build="1155517706"/>
          <size package="231174" archive="0"/>
          <base-version epoch="0" ver="1.5.0.3" rel="7" md5sum="3d4c72ac5f01f3c72e25037bfc2814b5" buildtime="1146621086" sequence_info="MozillaFirefox-translations-1.5.0.3-7-383ed4e6b0c9f95bb448dbbed59b04b0e7"/>
        </deltarpm>
      </pkgfiles>
    </package>
    <package xmlns="http://linux.duke.edu/metadata/common" type="rpm">
      <name>MozillaFirefox-translations</name>
      <arch>ppc</arch>
      <version epoch="0" ver="1.5.0.6" rel="1.3"/>
      <checksum type="sha" pkgid="YES">bfcbc852ec79ab1109dfb70e090992783e72d6a5</checksum>
      <time file="1155660928" build="1155562799"/>
      <size package="3753767" installed="20862963" archive="20872868"/>
      <location href="rpm/ppc/MozillaFirefox-translations-1.5.0.6-1.3.ppc.rpm"/>
      <format>
        <rpm:requires>
          <rpm:entry kind="package" name="MozillaFirefox-translations" epoch="0" ver="1.5.0.6" rel="1.3" flags="GE"/>
        </rpm:requires>
        <suse:freshens>
          <suse:entry kind="package" name="MozillaFirefox-translations"/>
        </suse:freshens>
      </format>
      <pkgfiles xmlns="http://novell.com/package/metadata/suse/patch">
        <patchrpm>
          <location href="rpm/ppc/MozillaFirefox-translations-1.5.0.6-1.3.ppc.patch.rpm"/>
          <checksum type="sha">6313c6f4a2aa69824e7df13d71a863b400db3de5</checksum>
          <time file="1155662084" build="1155562799"/>
          <size package="259680" archive="1494044"/>
          <base-version epoch="0" ver="1.5.0.3" rel="7"/>
          <base-version epoch="0" ver="1.5.0.4" rel="1.3"/>
        </patchrpm>
        <deltarpm>
          <location href="rpm/ppc/MozillaFirefox-translations-1.5.0.3_1.5.0.6-7_1.3.ppc.delta.rpm"/>
          <checksum type="sha">9af9b3771d6162ab8014f341965cfa65e1689946</checksum>
          <time file="1155662091" build="1155562799"/>
          <size package="231091" archive="0"/>
          <base-version epoch="0" ver="1.5.0.3" rel="7" md5sum="02f492be37e15c10a219a954e5da12f3" buildtime="1146627070" sequence_info="MozillaFirefox-translations-1.5.0.3-7-383ed4e6b0c9f95bb448dbbed59b04b0e7"/>
        </deltarpm>
      </pkgfiles>
    </package>
  </atoms>
</patch>
